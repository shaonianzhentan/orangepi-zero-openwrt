# Automatically generated file; DO NOT EDIT.
# OpenWrt configuration
#

# 目标设备：Orange Pi Zero（全志 H2+ 芯片，cortex-a7 架构）
CONFIG_TARGET_sunxi=y
CONFIG_TARGET_sunxi_cortexa7=y
CONFIG_TARGET_DEVICE_sunxi_cortexa7_DEVICE_orangepi_zero=y

# 固件镜像设置（适配低内存设备）
CONFIG_TARGET_IMAGES_GZIP=y                  # 固件压缩为 GZ 格式（减小体积）
CONFIG_TARGET_ROOTFS_SQUASHFS=y              # 只读根分区（适合嵌入式设备）
CONFIG_TARGET_ROOTFS_PARTSIZE=80             # 根分区 80MB（足够核心功能）
CONFIG_TARGET_IMAGES_PAD=y                   # 自动填充镜像大小（适配 SD 卡）
CONFIG_TARGET_ROOTFS_INITRAMFS=n             # 关闭 INITRAMFS（避免内存不足）

# 基础系统工具（精简必备）
CONFIG_BUSYBOX_DEFAULT_FEATURE_VERBOSE_USAGE=y
CONFIG_BUSYBOX_DEFAULT_FEATURE_PREFER_APPLETS=y
CONFIG_BUSYBOX_DEFAULT_FEATURE_INSTALLER=y
CONFIG_BUSYBOX_DEFAULT_FEATURE_IFUPDOWN_BUSYBOX=y
CONFIG_PACKAGE_ca-certificates=y             # SSL 证书（OpenClash 下载规则需要）
CONFIG_PACKAGE_resolvconf=y                  # DNS 配置工具（OpenClash 依赖）

# LuCI Web 管理界面（核心功能）
CONFIG_PACKAGE_luci=y                        # LuCI 核心
CONFIG_PACKAGE_luci-app-opkg=y               # 软件包管理
CONFIG_PACKAGE_luci-base=y                   # LuCI 基础组件
CONFIG_PACKAGE_luci-mod-admin-full=y         # 完整管理功能
CONFIG_PACKAGE_luci-theme-bootstrap=y        # 轻量主题（节省资源）
CONFIG_PACKAGE_luci-proto-ipv4=y             # IPv4 协议支持
CONFIG_PACKAGE_luci-proto-ipv6=y             # IPv6 协议支持（部分代理需要）

# 网络核心工具（旁路由必需）
CONFIG_PACKAGE_ip-full=y                     # 完整 IP 工具（配置静态 IP/路由）
CONFIG_PACKAGE_ipset=y                       # IP 集合（OpenClash 规则匹配）
CONFIG_PACKAGE_iptables-mod-tproxy=y         # TProxy 透明代理（核心功能）
CONFIG_PACKAGE_iptables-mod-extra=y          # 额外 iptables 模块（规则支持）
CONFIG_PACKAGE_kmod-ipt-nat=y                # NAT 转发支持
CONFIG_PACKAGE_kmod-ipt-ipset=y              # ipset 内核模块
CONFIG_PACKAGE_kmod-tproxy=y                 # TProxy 内核支持
CONFIG_PACKAGE_kmod-tun=y                    # TUN 设备（代理隧道）
CONFIG_PACKAGE_udhcpc=y                      # DHCP 客户端（获取主路由 IP）
CONFIG_PACKAGE_tc=y                          # 流量控制（优化延迟）

# OpenClash 及依赖（核心功能）
CONFIG_PACKAGE_luci-app-openclash=y          # OpenClash Web 界面
CONFIG_PACKAGE_openclash_core_lite=y         # 轻量版核心（适合低内存）
CONFIG_PACKAGE_dnsmasq=n                     # 关闭默认 DNS 服务
CONFIG_PACKAGE_dnsmasq-full=y                # 增强版 DNS（支持分流规则）
CONFIG_PACKAGE_dnsmasq-full_auth=y
CONFIG_PACKAGE_dnsmasq-full_conntrack=y
CONFIG_PACKAGE_dnsmasq-full_dhcp=y
CONFIG_PACKAGE_dnsmasq-full_dnssec=y
CONFIG_PACKAGE_libustream-openssl=y          # SSL 支持（下载规则/内核）
CONFIG_PACKAGE_coreutils-base64=y            # Base64 编码（规则解析）

# 网口驱动（确保 Orange Pi Zero 网口工作）
CONFIG_PACKAGE_kmod-sun4i-emac=y             # 全志 EMAC 网卡驱动
CONFIG_PACKAGE_kmod-rtl8211e=y               # RTL8211E PHY 芯片驱动（网口必需）

# 轻量工具（仅保留必要）
CONFIG_PACKAGE_curl=y                        # 网络请求工具（OpenClash 可能用到）
CONFIG_PACKAGE_wget=y                        # 下载工具（手动安装软件用）
CONFIG_PACKAGE_htop=y                        # 进程监控（查看内存占用，轻量）

# 禁用所有非必需功能（关键！节省内存）
CONFIG_PACKAGE_ppp=n                         # 关闭 PPP 拨号（旁路由无需）
CONFIG_PACKAGE_ppp-mod-pppoe=n
CONFIG_PACKAGE_kmod-ppp=n
CONFIG_PACKAGE_kmod-pppox=n
CONFIG_PACKAGE_kmod-pppoe=n
CONFIG_PACKAGE_smartdns=n                    # 关闭，避免与 OpenClash DNS 冲突
CONFIG_PACKAGE_frp=n                         # 关闭内网穿透（非必需）
CONFIG_PACKAGE_netdata=n                     # 关闭 heavy 监控
CONFIG_PACKAGE_ttyd=n                        # 关闭 Web 终端
CONFIG_PACKAGE_collectd=n                    # 关闭数据收集
CONFIG_PACKAGE_vim=n                         # 关闭，用 busybox 自带 vi
CONFIG_PACKAGE_mc=n                          # 关闭文件管理器
CONFIG_PACKAGE_bluetooth=n                   # 无蓝牙模块，关闭
CONFIG_PACKAGE_wireless-tools=n              # 无内置无线，关闭
CONFIG_PACKAGE_docker=n                      # 内存不足，关闭
CONFIG_PACKAGE_samba=n                       # 关闭文件共享
CONFIG_PACKAGE_kmod-nftables=n               # 禁用 nftables，优先 iptables
CONFIG_DISABLE_NFTABLES=y                    # 强制使用 iptables（OpenClash 兼容）